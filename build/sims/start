#!/bin/sh

started() {
    trap "stop $1 $2" 0
    echo "$1 started, pid $2"
}

stop() {
    kill "$2"
    sleep 1
    kill -9 "2"
    echo "$1 stopped"
}

gt40() {
    (sleep 3; tools/simh/BIN/pdp11 build/sims/gt40 >gt40.log 2>&1) &
    started GT40 "$!"
}

tv11() {
    (sleep 3; tools/tv11/tv11 -p 1234 localhost >tv11.log 2>&1) &
    started TV-11 "$!"
}

while test -n "$1"; do
    "$1"
    shift
done

tools/sims/BIN/ka10 build/sims/run
